(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,a){e.exports=a(22)},19:function(e,t,a){},21:function(e,t,a){e.exports=a.p+"static/media/Spotify_Logo_RGB_Green.11dc437a.png"},22:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),i=a(4),r=a.n(i),l=a(1),c=a.n(l),o=a(3),u=a(6),m=a(7),d=a(10),p=a(8),h=a(2),y=a(11),g=a(9),f=a.n(g),v=(a(19),function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(d.a)(this,Object(p.a)(t).call(this,e))).state={authenticated:!1,search:"",devices:[],currentDevice:"",playlist:null,playlistId:"",playlistName:"",playlistImageLink:"",allPlaylistSongs:[],selectedSongs:[],numRounds:10,isGameStarted:!1,songsPlayed:0,score:0,roundTimer:0,currentAnswerOptions:[]},a.onSubmit=a.onSubmit.bind(Object(h.a)(a)),a.reselectPlaylist=a.reselectPlaylist.bind(Object(h.a)(a)),a.checkAnswer=a.checkAnswer.bind(Object(h.a)(a)),a.nextSong=a.nextSong.bind(Object(h.a)(a)),a.generateAnswerOptions=a.generateAnswerOptions.bind(Object(h.a)(a)),a}return Object(y.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=Object(o.a)(c.a.mark(function e(){var t,a,s,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!window.location.hash){e.next=10;break}return t=window.location.hash.substring(1),a=new URLSearchParams(t).get("access_token"),this.spotifyClient=new f.a,this.spotifyClient.setAccessToken(a),e.next=7,this.spotifyClient.getMyDevices();case 7:s=e.sent,n=s.devices,this.setState({authenticated:!0,devices:n,currentDevice:n[0].id});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"startPlayback",value:function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.spotifyClient.play({device_id:this.state.currentDevice,uris:["spotify:track:".concat(t)]});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"pausePlayback",value:function(){var e=Object(o.a)(c.a.mark(function e(t){return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.spotifyClient.pause({device_id:this.state.currentDevice,uris:["spotify:track:".concat(t)]});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onSubmit",value:function(){var e=Object(o.a)(c.a.mark(function e(t){var a,s,n;return c.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,this.spotifyClient.searchPlaylists(this.state.search,{market:"us"});case 3:return a=e.sent,this.setState({playlist:a.playlists.items[0],playlistId:a.playlists.items[0].id,playlistName:a.playlists.items[0].name,playlistImageLink:a.playlists.items[0].images[0].url,playlistTracksLink:a.playlists.items[0].tracks.href}),e.next=7,this.spotifyClient.getPlaylistTracks(this.state.playlistId,{market:"us"});case 7:(s=e.sent).total<30&&(this.reselectPlaylist(),alert("Not enough tracks to play (<30). Please select other playlist.")),n=this.selectRandomSongs(s.items,this.state.numRounds),this.setState({allPlaylistSongs:s.items,selectedSongs:n});case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"reselectPlaylist",value:function(){this.setState({playlist:null,playlistId:"",playlistName:"",playlistImageLink:"",playlistTracksLink:"",isGameStarted:!1,songsPlayed:0,score:0,roundTimer:0})}},{key:"nextSong",value:function(){var e=this;this.state.songsPlayed>=this.state.numRounds?this.endGame():(this.setState({isGameStarted:!0}),this.setState({isGameStarted:!0},function(){e.generateAnswerOptions()}),this.startPlayback(this.state.selectedSongs[this.state.songsPlayed].id),this.interval=setInterval(function(){e.state.roundTimer>9?(e.setState({roundTimer:0}),e.pausePlayback(e.state.selectedSongs[e.state.songsPlayed].id),clearInterval(e.interval)):e.setState({roundTimer:e.state.roundTimer+1})},1e3))}},{key:"generateAnswerOptions",value:function(){for(var e=a(20),t=this.state.selectedSongs[this.state.songsPlayed],s=this.selectRandomSongs(this.state.allPlaylistSongs,3);s.includes(t);)s=this.selectRandomSongs(this.state.allPlaylistSongs,3);s.push(t),e(s),this.setState({currentAnswerOptions:s})}},{key:"endGame",value:function(){this.pausePlayback(),this.setState({isGameStarted:!1})}},{key:"selectRandomSongs",value:function(e,t){for(var a=[],s=0;s<t;s++){var n=e[Math.floor(Math.random()*e.length)].track;!a.includes(n)&&n.is_playable?a.push(n):s--}return a}},{key:"checkAnswer",value:function(e){var t=this,a=!1;clearInterval(this.interval),e.id===this.state.selectedSongs[this.state.songsPlayed].id&&(a=!0),a?this.setState({score:this.state.score+1,songsPlayed:this.state.songsPlayed+1,roundTimer:0},function(){t.nextSong()}):this.setState({songsPlayed:this.state.songsPlayed+1,roundTimer:0},function(){t.nextSong()})}},{key:"render",value:function(){var e=this,t=a(21);return this.state.authenticated?n.a.createElement("div",{className:"ui container"},n.a.createElement("div",{className:"logo-wrapper"},n.a.createElement("img",{className:"spotify-logo",src:t,alt:""})),""===this.state.playlistName&&n.a.createElement("div",{className:"ui container search-form"},n.a.createElement("form",{className:"ui form",onSubmit:this.onSubmit},n.a.createElement("input",{className:"search-input",type:"text",onChange:function(t){return e.setState({search:t.target.value})}}),n.a.createElement("input",{className:"search-button",type:"submit",value:"Search Playlist"})),n.a.createElement("select",{className:"ui dropdown",onChange:function(t){return e.setState({currentDevice:t.target.value})}},this.state.devices.map(function(e){return n.a.createElement("option",{key:e.id,value:e.id},e.name)}))),""!==this.state.playlistName&&n.a.createElement("div",{className:"ui container selected-playlist"},n.a.createElement("p",null,"Selected Playlist: ",this.state.playlistName),n.a.createElement("img",{className:"playlist-image",src:this.state.playlistImageLink,alt:""}),n.a.createElement("div",{className:"playlist-buttons"},n.a.createElement("button",{className:"reselect-playlist",onClick:this.reselectPlaylist},"Reselect Playlist"),!this.state.isGameStarted&&0===this.state.songsPlayed&&n.a.createElement("button",{className:"start-game",onClick:this.nextSong},"Start Game"),this.state.isGameStarted&&n.a.createElement("p",{className:"timer"},"Timer: ",10-this.state.roundTimer))),""!==this.state.playlistName&&this.state.isGameStarted&&n.a.createElement("div",{className:"ui container answer-options"},n.a.createElement("p",{className:"guess-header"},"Guess the song!"),this.state.currentAnswerOptions.map(function(t){return n.a.createElement("div",{className:"ui answer-item",key:t.id,onClick:function(){return e.checkAnswer(t)}},n.a.createElement("div",{className:"ui container"},void 0!==t.album.images[0]&&n.a.createElement("img",{className:"song-image",src:t.album.images[0].url,alt:""})),n.a.createElement("div",{className:"content song-info"},n.a.createElement("p",{className:"song-artists"},t.artists.map(function(e){return e.name}).join(", ")),n.a.createElement("p",{className:"song-name"},t.name)))}),n.a.createElement("p",{className:"round-score"},"Round: ",this.state.songsPlayed+1," | Score: ",this.state.score)),!this.state.isGameStarted&&this.state.songsPlayed>0&&n.a.createElement("div",{className:"ui container game-stats"},n.a.createElement("p",{className:"game-over-header"},"The game is over!"),n.a.createElement("p",{className:"game-over-score"},"Your final score is: ",this.state.score," out of ",this.state.songsPlayed,"."))):n.a.createElement("div",{className:"ui container centered login-page"},n.a.createElement("div",{className:"logo-wrapper"},n.a.createElement("img",{className:"spotify-logo",src:t,alt:""})),n.a.createElement("a",{className:"login-link",href:"https://accounts.spotify.com/authorize/?client_id=ac9ec319b658424d8aa1e41317e7c70f&response_type=token&redirect_uri=".concat(window.location.origin+window.location.pathname,"&scope=streaming user-read-playback-state user-modify-playback-state user-top-read user-read-private")},"Login to Spotify"))}}]),t}(n.a.Component)),S=document.getElementById("root");r.a.render(n.a.createElement(v,null),S);var k=v;r.a.render(n.a.createElement(k,null),document.getElementById("root"))}},[[12,1,2]]]);
//# sourceMappingURL=main.ca96e5ab.chunk.js.map